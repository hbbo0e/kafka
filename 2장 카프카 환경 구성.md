# 2.1 이 책의 실습 환경 구성

![[Pasted image 20240613193517.png]]

실제 운영 환경에서는 서비스의 안정성이 최우선이므로 단독 서버 형태로 운영하는 경우는 거의 없고, 대부분 이중화 또는 클러스터 형태로 구성한다.

**주키퍼**의 경우, 최소 수량은 EC2 인스턴스 3대
**카프카**의 경우, 최소 수량은 EC2 인스턴스 3대 로 구성되어 있다.

일반적으로 운영 환경에서는 애플리케이션 배포를 위해 별도의 배포 서버를 이용하는데, 위 사진에서도 배포 서버 1대를 포함했고 프라이빗 도메인을 위한 foo.bar 의 도메인도 표시했다.
통상적인 운영 환경에서 서버 간 통신에서 직접 서버의 IP 를 호출하거나 사용하는 방식은 거의 사용하지 않으며, 대부분 서버의 호스트네임과 IP 를 매핑하는 DNS 를 별도로 구성해 사용하는 것이 일반적이다.

## 2.1.1 AWS 환경에서 실습 환경 구성

# 2.2 카프카 클러스터 구성

앤서블은 오픈소스 소프트웨어로, 다수의 서버를 대상으로 설정 관리, 애플리케이션 배포 등을 코드로 관리할 수 있도록 도움을 주는 도구이다.
앤서블이 세상에 공개되기 이전에는 관리자들이 셀 스크립트 등을 이용해 서버를 관리하는 것이 일반적이었으나, 관리자 한 명이 관리해야 할 서버가 많아지자 사용법이 간단한 앤서블을 많이 사용하게 되었다.


# 2.3 5분 만에 카프카 맛보기

## 2.3.1 카프카의 기본 구성

**카프카는** 데이터를 받아서 전달하는 데이터 버스의 역할을 한다. 카프카에 데이터(메시지) 를 만들어서 주는 쪽을 `프로듀서`, 카프카에서 데이터 (메시지) 를 빼내서 소비하는 쪽을 `컨슈머` 라고 한다.

주키퍼는 카프카의 정상 동작을 보장하기 위해 메타데이터를 관리하는 코디네이터라고 할 수 있다.

![[Pasted image 20240613204234.png]]
	프로듀서와 컨슈머는 `클라이언트`이고, 중앙에 `카프카 애플리케이션`이 있고, 코디네이터 역할을 하는 `주키퍼 애플리케이션`이 있다.

메시지를 카프카로 전송하는 역할을 하는 프로듀서가 메시지를 어떻게 보내느냐에 따라 카프카에 메시지가 잘 저장될 수도 손실될 수도 있다.

`카프카`는 프로듀서로부터 전달 받은 메시지들을 저장하고 컨슈머에 메시지를 전달하는 두 가지 역할을 한다.
`주키퍼`는 메타데이터 저장소로 사용하며 브로커들의 노드 관리 등을 하고 있다.
	- 브로커 ?
	 : 카프카 애플리케이션이 설치된 서버 또는 노드를 의미한다.

컨슈머가 카프카에 저장된 메시지를 꺼내오면, `관리자`는 컨슈머와 데이터 프로세스를 결합할 수 있다. 엘라스틱서치나 하둡 같은 애플리케이션으로 전송하기도 하고, 메시지를 변형하여 다시 카프카로 전송하는 등 다양한 방법으로 응용해 사용할 수 있다.


## 2.3.2 메시지 보내고 받기

